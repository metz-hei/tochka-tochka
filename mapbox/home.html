<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Display driving directions</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v2.2.0/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v2.2.0/mapbox-gl.js"></script>
<script src="https://unpkg.com/@antv/l7"></script>

<style>
body { margin: 0; padding: 0; }
#map { position: absolute; top: 0; bottom: 0; width: 100%; }
</style>
</head>
<body>
<script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-directions/v4.1.0/mapbox-gl-directions.js"></script>
<link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-directions/v4.1.0/mapbox-gl-directions.css" type="text/css">
<div id="map"></div>

<script>

	mapboxgl.accessToken = 'pk.eyJ1IjoibWV0emhlaSIsImEiOiJja2cyY2tiaHgxZWNrMnJxZjZ3d21vYWlsIn0.kVbm92P50244g1bNX1aF9Q';
    var map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/metzhei/ckmqec56h10tz17o51xclzw8n',
        center: [-79.4512, 43.6568],
        pitch: 45,
        zoom: 9
    });

  
  mapboxgl.on('loaded', () => {
  Promise.all([
    fetch('https://gw.alipayobjects.com/os/basement_prod/dbd008f1-9189-461c-88aa-569357ffc07d.json').then(d => d.json()),
    fetch('https://gw.alipayobjects.com/os/basement_prod/4472780b-fea1-4fc2-9e4b-3ca716933dc7.json').then(d => d.text()),
    fetch('https://gw.alipayobjects.com/os/basement_prod/a5ac7bce-181b-40d1-8a16-271356264ad8.json').then(d => d.text())
  ]).then(function onLoad([ world, dot, flyline ]) {
    const dotData = eval(dot);
    const flydata = eval(flyline).map(item => {
      const latlng1 = item.from.split(',').map(e => { return e * 1; });
      const latlng2 = item.to.split(',').map(e => { return e * 1; });
      return { coord: [ latlng1, latlng2 ] };
    });
    // const worldFill = new PolygonLayer()
    //   .source(world)
    //   .color('#98E3FA')
    //   .shape('fill')
    //   .style({
    //     opacity: 1
    //   });

    const worldLine = new LineLayer()
      .source(world)
      .color('#41fc9d')
      .size(0.5)
      .style({
        opacity: 0.4
      });
    const dotPoint = new PointLayer()
      .source(dotData, {
        parser: {
          type: 'json',
          x: 'lng',
          y: 'lat'
        }
      })
      .shape('circle')
      .color('#ffed11')
      .animate(true)
      .size(40)
      .style({
        opacity: 1.0
      });
    const flyLine = new LineLayer()
      .source(flydata, {
        parser: {
          type: 'json',
          coordinates: 'coord'
        }
      })
      .color('#ff6b34')
      .shape('arc3d')
      .size(2)
      .active(true)
      .animate({
        interval: 2,
        trailLength: 2,
        duration: 1
      })
      .style({
        opacity: 1
      });
    // scene.addLayer(worldFill);
    scene.addLayer(worldLine);
    scene.addLayer(dotPoint);
    scene.addLayer(flyLine);
  });

});

</script>

</body>
</html>


</body>
</html>